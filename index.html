<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Anger Rescue â€” æƒ…ç»ªç¼“è§£å°å·¥å…·</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- React + ReactDOM -->
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <style>
    /* Simple shred animation */
    @keyframes shred {
      0% { transform: translateY(0) rotate(0deg); opacity: 1; }
      70% { transform: translateY(20px) rotate(8deg); opacity: 0.8; }
      100% { transform: translateY(200px) rotate(20deg); opacity: 0; }
    }
    .shredding { animation: shred 0.7s ease forwards; }
  </style>
</head>
<body class="bg-slate-50 min-h-screen flex items-center justify-center p-6">
  <div id="root" class="w-full max-w-md"></div>

  <script>
  const e = React.createElement;
  const { useState, useEffect, useRef } = React;

  function App(){
    const [view, setView] = useState('home');
    const [ventText, setVentText] = useState('');
    const [shredded, setShredded] = useState(false);
    const [countdown, setCountdown] = useState(0);
    const [breathStep, setBreathStep] = useState(0);
    const [microTask, setMicroTask] = useState(generateMicroTask());
    const [mood, setMood] = useState(6);
    const inputRef = useRef(null);

    useEffect(()=> {
      let t;
      if(countdown > 0){
        t = setTimeout(()=> setCountdown(c => c - 1), 1000);
      } else if (countdown === 0 && breathStep > 0) {
        // auto advance to next step if user doesn't click; keep it simple: stop after one step
      }
      return ()=> clearTimeout(t);
    }, [countdown, breathStep]);

    function generateMicroTask(){
      const tasks = [
        'ç«™èµ·æ¥ä¼¸å±• 30 ç§’',
        'å–ä¸€æ¯æ°´',
        'ç»™åŒäº‹å‘ä¸€æ¡ä¸€è¡Œçš„æ›´æ–°',
        'å¼€çª—é€æ°” 30 ç§’',
        'æ•´ç†ä¸€ä¸ªæ–‡ä»¶å¤¹é‡Œçš„ä¸‰ä»¶äº‹',
        'å†™ä¸‹ä»Šå¤©çš„ä¸€ä»¶å°èƒœåˆ©'
      ];
      return tasks[Math.floor(Math.random()*tasks.length)];
    }

    function startBoxBreathing(){
      setBreathStep(1);
      setCountdown(4);
      setView('breath');
    }

    function nextBreathStep(){
      if(breathStep >= 4){
        setBreathStep(0);
        setCountdown(0);
        setView('home');
      } else {
        setBreathStep(s => s + 1);
        setCountdown(4);
      }
    }

    function shredVent(){
      setShredded(true);
      setTimeout(()=>{
        setVentText('');
        setShredded(false);
        setView('home');
      }, 700);
    }

    function quickReframe(){
      const suggestions = [
        'æŠŠè¿™ä»¶äº‹å½“ä½œä¿¡æ¯ï¼šå®ƒæç¤ºäº†å“ªäº›è¾¹ç•Œéœ€è¦æ˜ç¡®ã€‚å†™ä¸‹ä¸€ä¸ªå¯ä»¥ç«‹åˆ»åšçš„å°è¾¹ç•Œã€‚',
        'ä½ çš„æƒ…ç»ªè¯´æ˜ä½ åœ¨ä¹è¿™ä»¶äº‹ã€‚æŒ‘ä¸€ä¸ªå¯æ‰§è¡Œçš„å°ç‚¹å»è¯•è¯•ï¼Œè€Œä¸æ˜¯æƒ³å…¨ç›˜æ”¹å˜ã€‚',
        'å…ˆæŠŠèƒ½æ§åˆ¶çš„æ‹†å‡ºæ¥ï¼šç¬¬ä¸€ä»¶èƒ½åšçš„äº‹æ˜¯______ã€‚',
        'æŠŠè¿™è‚¡èƒ½é‡è½¬ä¸ºä¸€ä¸ª 5 åˆ†é’Ÿçš„è¡ŒåŠ¨ï¼Œç”¨è¡ŒåŠ¨æ¶ˆè€—æ‰ç´§å¼ æ„Ÿã€‚'
      ];
      return suggestions[Math.floor(Math.random()*suggestions.length)];
    }

    return e('div', {className:'bg-white/95 backdrop-blur-sm rounded-2xl shadow p-4 ring-1 ring-slate-200'},
      e('div', {className:'flex items-center justify-between'},
        e('h3', {className:'text-lg font-semibold'}, 'Anger Rescue'),
        e('div', {className:'text-sm text-slate-500'}, 'å¾®äº¤äº’ Â· å‡å‹')
      ),
      e('div', {className:'mt-3'},
        view === 'home' && e('div', null,
          e('p', {className:'text-sm text-slate-600'}, 'æ„Ÿè§‰ç”Ÿæ°”äº†ï¼Ÿç‚¹ä¸€ä¸ªå°åŠ¨ä½œï¼Œè®©æƒ…ç»ªå…ˆåŠ¨èµ·æ¥è€Œä¸æ˜¯å¡ä½ã€‚'),
          e('div', {className:'grid grid-cols-2 gap-2 mt-4'},
            e('button', {onClick: ()=>{ setView('vent'); setTimeout(()=> inputRef.current?.focus(), 60) }, className:'p-2 rounded-lg border text-sm'}, 'å†™ä¸‹æ¥å¹¶ç¢çº¸'),
            e('button', {onClick: startBoxBreathing, className:'p-2 rounded-lg border text-sm'}, 'ç›’å¼å‘¼å¸ 1 è½®'),
            e('button', {onClick: ()=> setView('ground'), className:'p-2 rounded-lg border text-sm'}, '5-4-3 åœ°é¢æ³•'),
            e('button', {onClick: ()=>{ setMicroTask(generateMicroTask()); setView('task') }, className:'p-2 rounded-lg border text-sm'}, 'å®Œæˆä¸€ä¸ªå¾®ä»»åŠ¡'),
            e('button', {onClick: ()=> setView('reframe'), className:'col-span-2 p-2 rounded-lg border text-sm'}, 'å¿«é€Ÿæ¢ä¸ªè§’åº¦ï¼ˆAI é£æ ¼å»ºè®®ï¼‰')
          ),
          e('div', {className:'mt-4 flex items-center justify-between'},
            e('div', {className:'text-xs text-slate-500'}, 'æƒ…ç»ªåˆ»åº¦'),
            e('input', {type:'range', min:0, max:10, value:mood, onChange: (e)=> setMood(Number(e.target.value))})
          )
        ),

        view === 'vent' && e('div', null,
          e('textarea', {ref: inputRef, value: ventText, onChange: (e)=> setVentText(e.target.value), rows:5, className:'w-full rounded-md border p-2 text-sm', placeholder:'æŠŠæ°”å†™ä¸‹æ¥ï¼šä¸éœ€è¦æœ‰é€»è¾‘ï¼Œåªè¦çœŸå®'}),
          e('div', {className:'flex gap-2 mt-2'},
            e('button', {onClick: shredVent, disabled: !ventText, className:'flex-1 p-2 rounded-md bg-red-50 border text-sm'}, 'æ’•ç¢å¹¶æ¸…ç©º'),
            e('button', {onClick: ()=>{ navigator.clipboard?.writeText(ventText); setView('home') }, className:'p-2 rounded-md border text-sm'}, 'å¤åˆ¶')
          ),
          shredded && e('div', {className:'mt-2 p-2 bg-yellow-50 rounded shredding'}, 'ğŸ—‘ï¸ å·²æ’•ç¢ â€”â€” å‘¼å¸ä¸€ä¸‹'),
          e('div', {className:'mt-3 text-right'},
            e('button', {onClick: ()=> setView('home'), className:'text-sm text-slate-500'}, 'è¿”å›')
          )
        ),

        view === 'breath' && e('div', {className:'flex flex-col items-center py-4'},
          e('div', {className:'text-sm text-slate-600 mb-2'}, 'ç›’å¼å‘¼å¸ â€” å½“å‰æ­¥éª¤: ' + (breathStep === 1 ? 'å¸æ°”' : breathStep === 2 ? 'å±ä½' : breathStep === 3 ? 'å‘¼æ°”' : breathStep === 4 ? 'å±ä½' : '')),
          e('div', {className:'w-36 h-36 rounded-full grid place-items-center border'},
            e('div', {className:'text-2xl font-semibold'}, countdown > 0 ? countdown : 'â€”')
          ),
          e('div', {className:'mt-3 flex gap-2'},
            e('button', {onClick: nextBreathStep, className:'p-2 rounded-md border text-sm'}, 'ä¸‹ä¸€æ­¥'),
            e('button', {onClick: ()=>{ setView('home'); setBreathStep(0); setCountdown(0) }, className:'p-2 rounded-md text-sm'}, 'ç»“æŸ')
          ),
          e('div', {className:'mt-3 text-xs text-slate-500'}, 'æç¤ºï¼šå¸ 4s â†’ å± 4s â†’ å‘¼ 4s â†’ å± 4s. åš 1 è½®å³å¯æ˜æ˜¾å¹³ç¨³å¿ƒç‡ã€‚')
        ),

        view === 'ground' && e('div', null,
          e('ol', {className:'list-decimal ml-5 text-sm space-y-2 text-slate-700'},
            e('li', null, 'çœ‹è§å¹¶è¯´å‡º 5 æ ·ä½ èƒ½çœ‹åˆ°çš„ä¸œè¥¿'),
            e('li', null, 'å¬è§å¹¶è¯´å‡º 4 æ ·ä½ èƒ½å¬åˆ°çš„å£°éŸ³'),
            e('li', null, 'è§¦æ‘¸å¹¶è¯´å‡º 3 æ ·ä½ èƒ½ç¢°åˆ°çš„ä¸œè¥¿'),
            e('li', null, 'é—»åˆ°å¹¶è¯´å‡º 2 æ ·æ°”å‘³ï¼ˆå¦‚æœæ²¡æœ‰å°±æƒ³è±¡ï¼‰'),
            e('li', null, 'å°è¯•è¯´å‡º 1 æ ·ä½ ç°åœ¨èƒ½æ„Ÿå—åˆ°çš„å‘³é“æˆ–å£è…”æ„Ÿå—')
          ),
          e('div', {className:'mt-3 flex justify-between'},
            e('button', {onClick: ()=> setView('home'), className:'p-2 rounded-md border text-sm'}, 'å®Œæˆ'),
            e('button', {onClick: ()=>{ setView('task'); setMicroTask(generateMicroTask()) }, className:'p-2 rounded-md text-sm'}, 'è·³åˆ°å¾®ä»»åŠ¡')
          )
        ),

        view === 'task' && e('div', null,
          e('div', {className:'text-sm text-slate-700'}, 'å¾®ä»»åŠ¡ï¼ˆå»ºè®® 1â€“5 åˆ†é’Ÿï¼‰'),
          e('div', {className:'mt-2 p-3 rounded-md bg-gray-50 text-sm'}, microTask),
          e('div', {className:'mt-3 flex gap-2'},
            e('button', {onClick: ()=> setView('home'), className:'flex-1 p-2 rounded-md border text-sm'}, 'æˆ‘åšå®Œäº†'),
            e('button', {onClick: ()=> setMicroTask(generateMicroTask()), className:'p-2 rounded-md text-sm'}, 'æ¢ä¸€ä¸ª')
          )
        ),

        view === 'reframe' && e('div', null,
          e('div', {className:'text-sm text-slate-700'}, 'å¿«é€Ÿå»ºè®®ï¼ˆæœ¬åœ°ç”Ÿæˆï¼Œå®‰å…¨ã€æ— ä¿å­˜ï¼‰'),
          e('div', {className:'mt-2 p-3 rounded-md bg-blue-50 text-sm'}, quickReframe()),
          e('div', {className:'mt-3 flex gap-2'},
            e('button', {onClick: ()=> setView('home'), className:'flex-1 p-2 rounded-md border text-sm'}, 'å¥½ æˆ‘å›å»è¯•è¯•'),
            e('button', {onClick: ()=> alert('å¦‚æœä½ æƒ³æ¥å…¥åœ¨çº¿AIä»¥è·å¾—ä¸ªæ€§åŒ–å»ºè®®ï¼Œæˆ‘å¯ä»¥ç»™ä½ åç«¯ç¤ºä¾‹å’Œå®‰å…¨è¯´æ˜ã€‚') , className:'p-2 rounded-md text-sm'}, 'éœ€è¦æ›´å¤šå»ºè®®')
          )
        )
      ),
      e('div', {className:'mt-4 text-xs text-slate-400'}, 'æ³¨ï¼šæ­¤å·¥å…·ä¸ºæƒ…ç»ªç¼“è§£è¾…åŠ©ï¼Œä¸æ›¿ä»£ä¸“ä¸šå¿ƒç†å’¨è¯¢ã€‚å¦‚é•¿æœŸæƒ…ç»ªå›°æ‰°è¯·å¯»æ±‚ä¸“ä¸šå¸®åŠ©ã€‚')
    );
  }

  ReactDOM.createRoot(document.getElementById('root')).render(e(App));
  </script>
</body>
</html>
